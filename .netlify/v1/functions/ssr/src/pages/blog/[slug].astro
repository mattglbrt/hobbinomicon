---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const posts = await getCollection('blog');

  return posts.map((post) => ({
    params: { slug: post.slug },
  }));
}

const { slug } = Astro.params;
const posts = await getCollection('blog');
const post = posts.find((post) => post.slug === slug);
---

<BaseLayout title={post ? `${post.data.title} | Hobbinomicon` : "Post Not Found | Hobbinomicon"}>
  <section class="py-12">
    <div class="max-w-4xl mx-auto px-4">

      {post ? (
        <>
          <!-- Breadcrumbs -->
          <nav class="text-sm mb-6 text-gray-500">
            <a href="/" class="hover:text-red-600">Home</a> &rsaquo; 
            <a href="/blog" class="hover:text-red-600">Blog</a> &rsaquo; 
            <span class="text-gray-900">{post.data.title}</span>
          </nav>

          <!-- Post Header -->
          <h1 class="text-4xl font-bold mb-4">{post.data.title}</h1>
          <p class="text-gray-500 text-sm mb-8">{new Date(post.data.pubDate).toLocaleDateString()}</p>

          <!-- Featured Image -->
          {post.data.featuredImage && (
            <img src={post.data.featuredImage} alt={post.data.title} class="rounded-lg mb-8 w-full" />
          )}

          <!-- Post Content -->
          <article class="prose prose-lg max-w-none">
            {post.body}
          </article>
        </>
      ) : (
        <div class="text-center py-24">
          <h2 class="text-2xl font-bold">Post not found.</h2>
        </div>
      )}

    </div>
  </section>
</BaseLayout>

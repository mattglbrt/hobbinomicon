---
import BaseLayout from "../layouts/BaseLayout.astro";
import { supabase } from "../lib/supabase";

const { data: games } = await supabase
  .from('games')
  .select('id, title, slug, tags, official_website')
  .order('created_at', { ascending: false })
  .limit(6);
---

<BaseLayout title="Home | Hobbinomicon">
  <!-- Hero Section -->
  <section class="bg-blue-600 text-white py-20 text-center">
    <div class="container mx-auto px-4">
      <h1 class="text-5xl font-bold mb-4">Find Your Next Adventure</h1>
      <p class="text-lg text-blue-100">Discover tabletop wargames, RPGs, and local stores â€” all in one place.</p>
    </div>
  </section>

  <!-- Featured Games -->
  <section class="py-16 bg-gray-100">
    <div class="container mx-auto px-4">
      <h2 class="text-3xl font-bold mb-8 text-center">Featured Games</h2>

      {games && games.length > 0 ? (
        <div class="grid gap-8 grid-cols-1 sm:grid-cols-2 md:grid-cols-3">
          {games.map(game => (
            <a href={`/games/${game.slug}`} class="block bg-white rounded-lg shadow hover:shadow-lg transition p-6">
              <h3 class="text-2xl font-semibold mb-2">{game.title}</h3>
              <div class="flex flex-wrap gap-2 mb-4">
                {game.tags && game.tags.map(tag => (
                  <span class="text-xs bg-blue-100 text-blue-700 rounded-full px-3 py-1">{tag}</span>
                ))}
              </div>
              {game.official_website && (
                <p class="text-sm text-blue-600 underline">Official Website</p>
              )}
            </a>
          ))}
        </div>
      ) : (
        <p class="text-center text-gray-500">No games found. Add some games to your database!</p>
      )}
    </div>
  </section>
</BaseLayout>

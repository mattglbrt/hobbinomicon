---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const { tag } = Astro.params;
const posts = await getCollection("blog");
const filtered = posts.filter((p) => p.data.tags.map(t => t.toLowerCase().replace(/\s+/g, '-')).includes(tag));
---

<BaseLayout title={`${tag.replace('-', ' ')} Posts | Hobbinomicon`}>
  <main class="max-w-6xl mx-auto p-6">
    <h1 class="text-4xl font-bold mb-6 capitalize">{tag.replace('-', ' ')}</h1>

    <section class="grid md:grid-cols-3 gap-8">
      {filtered.map((post) => (
        <a href={`/blog/${post.data.slug}`} class="block border rounded overflow-hidden hover:shadow-lg">
          <img src={post.data.featuredImage} alt={post.data.title} class="w-full h-48 object-cover" />
          <div class="p-4">
            <h3 class="text-xl font-bold">{post.data.title}</h3>
            <p class="text-sm text-gray-600 mt-2">{post.data.description}</p>
          </div>
        </a>
      ))}
    </section>
  </main>
</BaseLayout>

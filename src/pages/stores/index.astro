---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { supabase } from "../../lib/supabase";

const { data: stores, error } = await supabase.from("stores").select("*");

if (error) {
  console.error("Failed to fetch stores:", error);
}
---

<BaseLayout title="Find Local Game Stores | Hobbinomicon">
  <section class="max-w-7xl mx-auto px-4 py-12">
    <h1 class="text-3xl md:text-4xl font-bold mb-8 text-center">Local Game Stores</h1>

    {stores && stores.length > 0 ? (
      <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
        {stores.map((store) => (
          <a href={`/stores/${store.slug}`} class="block bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition">
            <div class="p-6">
              <h2 class="text-xl font-bold mb-2">{store.name}</h2>
              {store.location && (
                <p class="text-gray-600 text-sm mb-2">{store.location}</p>
              )}
              <p class="text-gray-700 line-clamp-3">{store.description}</p>
            </div>
          </a>
        ))}
      </div>
    ) : (
      <p class="text-center text-gray-600">No stores found.</p>
    )}
  </section>
</BaseLayout>

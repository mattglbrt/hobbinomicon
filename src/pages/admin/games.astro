---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { supabase } from "../../lib/supabase";
import "../../styles/global.css";

const { data: games, error } = await supabase
  .from('games')
  .select('*')
  .order('title', { ascending: true });

if (error) {
  console.error('Error fetching games:', error.message);
}
---

<BaseLayout title="Admin | Manage Games">
  <main class="max-w-7xl mx-auto px-4 py-10">
    <h1 class="text-4xl font-bold mb-10 text-center">Manage Games</h1>

    {games && games.length > 0 ? (
      <div class="overflow-x-auto">
        <table class="min-w-full bg-white border rounded-lg overflow-hidden">
          <thead class="bg-gray-100">
            <tr>
              <th class="text-left py-3 px-4 font-semibold text-sm">Title</th>
              <th class="text-left py-3 px-4 font-semibold text-sm">Slug</th>
              <th class="text-left py-3 px-4 font-semibold text-sm">Actions</th>
            </tr>
          </thead>
          <tbody>
            {games.map(game => (
              <tr class="border-t hover:bg-gray-50 transition">
                <td class="py-3 px-4">{game.title}</td>
                <td class="py-3 px-4 text-gray-500">{game.slug}</td>
                <td class="py-3 px-4 space-x-2">
                  <a 
                    href={`/admin/edit-game/${game.slug}`} 
                    class="inline-block bg-blue-600 text-white px-4 py-1 rounded hover:bg-blue-700 text-sm"
                  >
                    Edit
                  </a>
                  <!-- Future: Delete button here -->
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    ) : (
      <div class="text-center text-gray-500">No games found.</div>
    )}
  </main>
</BaseLayout>
